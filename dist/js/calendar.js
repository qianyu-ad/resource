$(function(){$("#calendar").calendar({ifSwitch:!0,hoverDate:!0,backToday:!0})}),function(t,a,e,i){function s(t){var a=t.getFullYear(),e=t.getMonth()+1,i=t.getDate();return e=e<=9?"0"+e:""+e,i=i<=9?"0"+i:""+i,a+e+i}function l(t){var a=t.split("-");return new Date(a[0],a[1]-1,a[2])}var n=function(a,e){this.$calendar=a,this.defaults={ifSwitch:!0,hoverDate:!1,backToday:!1},this.opts=t.extend({},this.defaults,e)};n.prototype={showHoverInfo:function(a){var e=t(a).attr("data"),i=t(a).offset().top+(this.$calendar_today.height()-t(a).height())/2,s=t(a).offset().left+t(a).width(),n=e.substr(0,4)+"-"+e.substr(4,2)+"-"+e.substring(6),r=l(n).getDay(),c="";switch(this.$calendar_today.show(),this.$calendar_today.css({left:s+30,top:i}).stop().animate({left:s+16,top:i,opacity:1}),r){case 0:c="星期日";break;case 1:c="星期一";break;case 2:c="星期二";break;case 3:c="星期三";break;case 4:c="星期四";break;case 5:c="星期五";break;case 6:c="星期六"}this.$calendarToday_date.text(n),this.$calendarToday_week.text(c)},showCalendar:function(){var a=r.getDate().getFullYear(),e=r.getDate().getMonth()+1,i=s(r.getDate()),l=new Date(a,e-1,1);this.$calendarTitle_text.text(a+"/"+i.substr(4,2)),this.$calendarDate_item.each(function(i){var n=new Date(a,e-1,i+1-l.getDay()),r=s(n);t(this).text(n.getDate()).attr("data",r),s(new Date)===r?t(this).attr("class","item item-curDay"):s(l).substr(0,6)===r.substr(0,6)?t(this).attr("class","item item-curMonth"):t(this).attr("class","item")})},renderDOM:function(){this.$calendar_title=t('<div class="calendar-title"></div>'),this.$calendar_week=t('<ul class="calendar-week"></ul>'),this.$calendar_date=t('<ul class="calendar-date"></ul>'),this.$calendar_today=t('<div class="calendar-today"></div>');for(var a='<a href="#" class="title"></a><a href="javascript:;" id="backToday">T</a><div class="arrow"><span class="arrow-prev"><</span><span class="arrow-next">></span></div>',e='<li class="item">日</li><li class="item">一</li><li class="item">二</li><li class="item">三</li><li class="item">四</li><li class="item">五</li><li class="item">六</li>',i="",s='<i class="triangle"></i><p class="date"></p><p class="week"></p>',l=0;l<6;l++)i+='<li class="item">26</li><li class="item">26</li><li class="item">26</li><li class="item">26</li><li class="item">26</li><li class="item">26</li><li class="item">26</li>';this.$calendar_title.html(a),this.$calendar_week.html(e),this.$calendar_date.html(i),this.$calendar_today.html(s),this.$calendar.append(this.$calendar_title,this.$calendar_week,this.$calendar_date,this.$calendar_today),this.$calendar.show()},inital:function(){var a=this;this.renderDOM(),this.$calendarTitle_text=this.$calendar_title.find(".title"),this.$backToday=t("#backToday"),this.$arrow_prev=this.$calendar_title.find(".arrow-prev"),this.$arrow_next=this.$calendar_title.find(".arrow-next"),this.$calendarDate_item=this.$calendar_date.find(".item"),this.$calendarToday_date=this.$calendar_today.find(".date"),this.$calendarToday_week=this.$calendar_today.find(".week"),this.showCalendar(),this.opts.ifSwitch&&(this.$arrow_prev.bind("click",function(){var t=r.getDate();r.setDate(new Date(t.getFullYear(),t.getMonth()-1,1)),a.showCalendar()}),this.$arrow_next.bind("click",function(){var t=r.getDate();r.setDate(new Date(t.getFullYear(),t.getMonth()+1,1)),a.showCalendar()})),this.opts.backToday&&this.$backToday.bind("click",function(){a.$calendarDate_item.hasClass("item-curDay")||(r.setDate(new Date),a.showCalendar())}),this.$calendarDate_item.hover(function(){a.showHoverInfo(t(this))},function(){a.$calendar_today.css({left:0,top:0}).hide()})},constructor:n},t.fn.calendar=function(t){var a=new n(this,t);return a.inital()};var r=function(){var t=new Date;return{getDate:function(){return t},setDate:function(a){t=a}}}()}(jQuery,window,document);